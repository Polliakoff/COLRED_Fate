{% extends 'main/header_base.html' %}
{% block list %}
{% load static %}
<link rel="stylesheet" href="{% static 'main/css/list.css' %}">
<link rel="stylesheet" href="{% static 'main/css/lk.css' %}">
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous">
    </script>
<!-- <script type="text/javascript" src="{% static 'main/js/login.js' %}"></script> -->
{% endblock %}

{% block title %}
{{current_character.name}}
{% endblock %}

{% block title_in_header %}
Персонаж: {{current_character.name}}
{% endblock %}

{% block username %}
{{ username }}
{% endblock %}

{% block ava_image %}{{ avatar }}{% endblock %}

{% block content %}
<div id="popup" class="popup">
    <div class="popup_body">
        <div class="popup_content">
            <a href="#the_header" class="popup_close">X</a>
            <h3 class="popup_title">Выберите портрет песонажа</h3>
            <br>
            <form method="post" class="little_form" enctype="multipart/form-data">
                {% csrf_token %}
                {{portrait_form}}
                <br>
                <button type="submit" class="little_button" name = "ava_form">Сменить</button>
            </form>
        </div>
    </div>
</div>

<div class="main_grid">
    <div class="profiles">
        {% for chr in characters %}
        <a href="/redactor/{{chr.usr.id}}/{{chr.id}}">
            <div class="listing" guys_id = "{{chr.id}}">
                <div class="char_logo">
                    {% if chr.custom_avatar %}
                        <img src='/media/{{chr.portrait}}' alt="+">
                    {% else %}
                        <img src='/static/main/images/avatars/blank.png' alt="+">
                    {% endif %}
                </div>
                <div>{{chr.name}}</div>
            </div>
        </a>
        {% endfor %}
    
        <a href="/create_new">
            <div class="listing addnew">
                <div>+</div>
            </div>
        </a>
    </div>
    <div class="inform_box" current_guy = "{{current_character.id}}">
        <a href="#popup">
            <div class="char_logo_list char_logo list_form">
                <img src="{{chr_portrait}}" alt="+">
            </div>
        </a>
        
        <form action="" method="post" id="form_1" class="list_form">
            <h2>ID</h2>
            {% csrf_token %}
            {{form_1}}
        </form>

        <form action="" method="post" id="fate_points" class="list_form">
            <h2>Фейт поинты</h2>
            {% csrf_token %}
            {{fate_points}}
            <button class="little_button" id = "refresh_button">Возобновить</button>
        </form>

        <form action="" method="post" id="main_aspects" class="list_form">
            <h2>Аспекты</h2>
            {% csrf_token %}
            {{main_aspects}}

            <div>Other aspects:</div>
            {% for asp in aspects %}
             <div class="sec_asp_div">
                <textarea class="line_area secondary_aspect_input" aspect_in_question = "{{asp.id}}">{{asp}}</textarea>
                <a class="little_button secondary_aspect_delete_button" aspect_in_question = "{{asp.id}}">X</a>
             </div>
            {% endfor %}

            <button class="little_button" id = "aspect_add_button" name="add_new_aspect">Добавить аспект</button>
        </form>

        <form action="" method="post" id="stunts" class="list_form">
            <h2>Трюки</h2>
            {% csrf_token %}
            {% for stn in stunts %}
             <div class="stunt_upper_div" stunt_in_question = "{{stn.id}}">
                <input type="checkbox" class="stunt_drop_down_choice" stunt_in_question = "{{stn.id}}">
                <div class="stunt_div" stunt_in_question = "{{stn.id}}">
                    <div>Name:</div>
                    <textarea class="line_area stunt_name_input" stunt_in_question = "{{stn.id}}">{{stn}}</textarea>
                    <div class="stunt_to_hide" stunt_in_question = "{{stn.id}}">
                        <div>Description:</div>
                        <textarea class="med_area stunt_desc_input" stunt_in_question = "{{stn.id}}">{{stn.desc}}</textarea>
                    </div>
                 </div>
                 <a class="little_button stunt_delete_button" stunt_in_question = "{{stn.id}}">X</a>
             </div>
            {% endfor %}

            <button class="little_button" id = "stunt_add_button" name="add_new_stunt">Добавить трюк</button>
        </form>

        <form action="" method="post" id="extras" class="list_form">
            <h2>Дополнения</h2>
            {% csrf_token %}
            {% for ext in extras %}
             <div class="extra_upper_div" extra_in_question = "{{ext.id}}">
                <input type="checkbox" class="extra_drop_down_choice" extra_in_question = "{{ext.id}}">
                <div class="extra_div" extra_in_question = "{{ext.id}}">
                    <div>Name:</div>
                    <textarea class="line_area extra_name_input" extra_in_question = "{{ext.id}}">{{ext}}</textarea>
                    <div class="extra_to_hide" extra_in_question = "{{ext.id}}">
                        <div>Cost:</div>
                        <textarea class="line_area extra_cost_input" extra_in_question = "{{ext.id}}">{{ext.cost}}</textarea>
                        <div>Attached aspects:</div>
                        <textarea class="med_area extra_attached_aspects_input" extra_in_question = "{{ext.id}}">{{ext.attached_aspects}}</textarea>
                        <div>Attached stunts:</div>
                        <textarea class="med_area extra_attached_stunts_input" extra_in_question = "{{ext.id}}">{{ext.attached_stunts}}</textarea>
                        <div>Attached skills:</div>
                        <textarea class="med_area extra_attached_skills_input" extra_in_question = "{{ext.id}}">{{ext.attached_skills}}</textarea>
                        <div>Details:</div>
                        <textarea class="med_area extra_details_input" extra_in_question = "{{ext.id}}">{{ext.details}}</textarea>
                    </div>
                 </div>
                 <a class="little_button extra_delete_button" extra_in_question = "{{ext.id}}">X</a>
             </div>
            {% endfor %}

            <button class="little_button" id = "extra_add_button" name="add_new_extra">Добавить дополнение</button>
        </form>

            
        <!-- Невидимые технические формы и инпуты ================================================================================ -->
        <form action="" method="post" id="delete_aspect_form" class="technical_object">
            {% csrf_token %}
            <input type="number" name="to_delete_ident_input" id="to_delete_ident_input">
        </form>

        <form action="" method="post" id="update_aspect_form" class="technical_object">
            {% csrf_token %}
            <input type="number" name="to_update_ident_input" id="to_update_ident_input">
            <input type="text" name="to_update_text_input" id="to_update_text_input">
        </form>


        <form action="" method="post" id="delete_stunt_form" class="technical_object">
            {% csrf_token %}
            <input type="number" name="stunt_to_delete_ident_input" id="stunt_to_delete_ident_input">
        </form>

        <form action="" method="post" id="update_stunt_form" class="technical_object">
            {% csrf_token %}
            <input type="number" name="stunt_to_update_ident_input" id="stunt_to_update_ident_input">
            <input type="text" name="stunt_to_update_text_input" id="stunt_to_update_text_input">
            <input type="text" name="stunt_to_update_desc_text_input" id="stunt_to_update_desc_text_input">
        </form>


        <form action="" method="post" id="delete_extra_form" class="technical_object">
            {% csrf_token %}
            <input type="number" name="extra_to_delete_ident_input" id="extra_to_delete_ident_input">
        </form>

        <form action="" method="post" id="update_extra_form" class="technical_object">
            {% csrf_token %}
            <input type="number" name="extra_to_update_ident_input" id="extra_to_update_ident_input">
            <input type="text" name="extra_to_update_text_input" id="extra_to_update_text_input">
            <input type="text" name="extra_to_update_cost_text_input" id="extra_to_update_cost_text_input">
            <input type="text" name="extra_to_update_attached_aspects_text_input" id="extra_to_update_attached_aspects_text_input">
            <input type="text" name="extra_to_update_attached_stunts_text_input" id="extra_to_update_attached_stunts_text_input">
            <input type="text" name="extra_to_update_attached_skills_text_input" id="extra_to_update_attached_skills_text_input">
            <input type="text" name="extra_to_update_details_text_input" id="extra_to_update_details_text_input">
        </form>


    </div>
</div>



<script type="text/javascript" src="{% static 'main/js/list.js' %}"></script>
<script type="text/javascript" src="{% static 'main/js/lk.js' %}"></script>
{% endblock %}